# Исправление проблемы с дублированием обработки отношений

## Проблема
Система отношений обрабатывала каждый эффект дважды:
- `UPDATE_RELATIONSHIP` вызывался дважды для каждого изменения
- В результате отношения неправильно накапливались
- Например: +10, +8, +12, +15, +5, +25 должно давать 75, но давало неправильный результат

## Причина
В `episodeManager.js` было два места обработки отношений:
1. **Строка 673**: `case 'relationship':` - обрабатывал `effects.relationship`
2. **Строка 695**: `case 'relationships':` - обрабатывал `effects.relationships`

В сценах используется формат `"relationship"` (единственное число), но система обрабатывала его дважды:
- Один раз в `case 'relationship'`
- Второй раз в `case 'relationships'` (который вызывал `processRelationshipEffects`)

## Исправления

### 1. Убрана дублирующая обработка в episodeManager.js
**Файл**: `src/utils/episodeManager.js`
```javascript
// УДАЛЕНО:
case 'relationships':
  // Обрабатываем отношения
  this.processRelationshipEffects(value);
  break;

// ОСТАВЛЕНО:
case 'relationship':
  // Обрабатываем отношения
  // ... логика обработки
  break;
```

### 2. Удален неиспользуемый метод processRelationshipEffects
**Файл**: `src/utils/episodeManager.js`
```javascript
// УДАЛЕН весь метод:
processRelationshipEffects(relationshipEffects) {
  // ... логика
}
```

## Результат
- Каждый эффект отношений обрабатывается только один раз
- Система правильно накапливает изменения отношений
- Убрана избыточная сложность в коде
- Улучшена производительность

## Тестирование
После исправлений:
1. Очистите все сохранения
2. Начните главу 3 с самого начала
3. Выберите варианты: +10, +8, +12, +15, +5, +25
4. Проверьте, что итоговое значение отношений = 75

## Логи
Теперь в логах должно быть:
- Один вызов `UPDATE_RELATIONSHIP` для каждого изменения
- Правильная последовательность значений: 10 → 18 → 30 → 45 → 50 → 75 